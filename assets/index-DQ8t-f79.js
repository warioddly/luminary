var c=Object.defineProperty;var h=(n,t,i)=>t in n?c(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var a=(n,t,i)=>(h(n,typeof t!="symbol"?t+"":t,i),i);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function i(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(e){if(e.ep)return;e.ep=!0;const o=i(e);fetch(e.href,o)}})();class u{constructor(t){a(this,"canvas");a(this,"container");a(this,"video");a(this,"options",{container:"#app-video-container",video:"#app-video",padding:30,background:{opacity:.7,blur:170,duration:1,animation:"fadeIn"}});if(this.options={...this.options,...t},this.container=document.querySelector(this.options.container),this.video=document.querySelector(this.options.video),!this.container||!this.video)throw new Error("Container or Video not found");this.video.addEventListener("loadedmetadata",this.init.bind(this)),window.addEventListener("resize",this.setupBackground.bind(this))}init(){this.createCanvas(),this.setupBackground(),this.render()}getVideoStream(){var i;let t=this.canvas;if(!(!t||!this.video)&&((i=t.getContext("2d"))==null||i.drawImage(this.video,0,0,t.width,t.height),this.container)){const r=t.toDataURL("image/png");this.container.style.backgroundImage=`url(${r})`}}createCanvas(){const{width:t,height:i}=this.getVideoRectBounds();this.canvas=document.createElement("canvas"),this.canvas.width=t+this.options.padding,this.canvas.height=i+this.options.padding}setupBackground(){const{width:t,height:i}=this.getVideoRectBounds();if(!this.container)throw new Error("Container not found");const{animation:r,duration:e,opacity:o,blur:s}=this.options.background,d=this.options.padding;this.container.style.width=`${t+d}px`,this.container.style.height=`${i+d}px`,this.container.style.opacity=`${o||.6}`,this.container.style.position="absolute",this.container.style.zIndex="-1",this.container.style.filter=`blur(${s||150}px)`,this.container.style.top=`-${d/2}px`,this.container.style.left=`-${d/2}px`,this.container.style.animation=`${r} ${e}s ease-in-out`,this.container.style.transition="background-image"}render(){this.video&&this.video.readyState===this.video.HAVE_ENOUGH_DATA&&this.getVideoStream(),requestAnimationFrame(this.render.bind(this))}getVideoRectBounds(){if(!this.video)return{width:0,height:0};const t=this.video.getBoundingClientRect();return{width:t.width,height:t.height}}}document.querySelector("#app").innerHTML=`
  <div style="position: relative">
      <video
            controls
            autoplay
            loop
            muted
            id="app-video"
        >
            <source src="./kyrgyz-warriors.mp4" type="video/mp4">
            Your browser does not support the video tag.
        </video>  
        <div id="app-video-container"></div>
  </div>
`;new u;
